{% load static %}
{% load custom_context %}

{% block more_link %}                              
<link rel="stylesheet" href="{% static 'css/navbar/navbar.css' %}">             
{% endblock more_link %}

<nav class="navbar navbar-expand-lg ps-5 pe-5 sticky-sm-top" data-bs-theme="dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="{% url 'home_page' %}">
      <img class="logo" src="{% static 'css/navbar/Logo.png' %}" alt="Logo">
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link " aria-current="page" href="{% url 'home_page' %}">Home</a>
        </li>
        <li class="nav-item">
          {% if request.user.is_authenticated %}
          <a class="nav-link" href="{% url 'apartments' %}">Apartments</a>
          {% else %}
          <a class="nav-link" data-bs-toggle="modal" data-bs-target="#signinModal" href="{% url 'sign_in' %}">Apartments</a>
          {% endif %}
        </li>
        <li class="nav-item">
          {% if request.user.is_authenticated %}
          <a class="nav-link" href="{% url 'trends' %}">Trends</a>
          {% else %}
          <a class="nav-link" data-bs-toggle="modal" data-bs-target="#signinModal" href="{% url 'sign_in' %}">Trends</a>
          {% endif %}
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'about' %}">About</a>
        </li>
      </ul>

      
      <!-- Notification Button-->
      {% if request.user.is_authenticated %}
      <button type="button" class="notify-button btn btn-* position-relative" onclick="window.location.href='{% url 'notification'%}' ;">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="Black" class="bi bi-bell" viewBox="0 0 16 16">
          <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zM8 1.918l-.797.161A4.002 4.002 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4.002 4.002 0 0 0-3.203-3.92L8 1.917zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5.002 5.002 0 0 1 13 6c0 .88.32 4.2 1.22 6z"/>
        </svg>
        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
          99+
          <span class="visually-hidden">unread messages</span>
        </span>
      </button>

      <!-- Bookmarks Button-->
      <button type="button" class="btn btn-*" onclick="window.location.href='{% url 'bookmarks' %}' ;">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="Black" class="bi bi-bookmarks" viewBox="0 0 16 16">
          <path d="M2 4a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v11.5a.5.5 0 0 1-.777.416L7 13.101l-4.223 2.815A.5.5 0 0 1 2 15.5V4zm2-1a1 1 0 0 0-1 1v10.566l3.723-2.482a.5.5 0 0 1 .554 0L11 14.566V4a1 1 0 0 0-1-1H4z"/>
          <path d="M4.268 1H12a1 1 0 0 1 1 1v11.768l.223.148A.5.5 0 0 0 14 13.5V2a2 2 0 0 0-2-2H6a2 2 0 0 0-1.732 1z"/>
        </svg>
         <span class="badge bg-secondary">4</span>
      </button>

      <!-- User Profile Dropdown-->
      <ul class="navbar-nav ml-auto ">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            
            {% profile_context request.user as p %}
            
            {% if p.profile_image.url is not None %}
                <img src="{{p.profile_image.url}}" alt="{{p.first_name}}" class="rounded-circle" style="width: 30px; height: 30px;">
            {% else %}
                <img src="{% static 'images/blank_profile_image.png' %}" alt="{{p.first_name}}" class="rounded-circle" style="width: 30px; height: 30px;">
            {% endif %}
              
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{% url 'profile_post' user.username %}">Profile</a></li>
            <li><a class="dropdown-item" href="{% url 'notification' %}">Notification</a></li>
            <li><a class="dropdown-item" href="{% url 'bookmarks' %}">Bookmarks</a></li>
            <li><a class="dropdown-item" href="{% url 'settings' %}">Settings</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="{% url 'log_out' %}">Log Out</a></li>
          </ul>
        </li>
      </ul>


      {% else %}
      <!-- Sign up + Sign in-->
      <a class="btn btn-custom me-3" data-bs-toggle="modal" data-bs-target="#signupModal_base" href="{% url 'signup_base' %}">Sign Up</a>
      <a class="btn btn-custom" data-bs-toggle="modal" data-bs-target="#signinModal" href="{% url 'sign_in' %}">Sign In</a>
      {% endif %}

    </div>
  </div>
</nav>


<!-- Modal Signin-->
<div class="modal fade" id="signinModal" tabindex="-1" aria-labelledby="signinModals" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
        {% include 'Signin/login.html' %}
      </div>
    </div>
  </div>
</div>

<!-- Modal base Signup -->
<div class="modal fade" id="signupModal_base" tabindex="-1" aria-labelledby="signupModal_base" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
        {% include 'Signup/base_signup.html' %}
      </div>
    </div>
  </div>
</div>

<!-- Modal SignUp Landlord #1-->
<div class="modal fade" id="signupModal1" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="signupModal1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <div class="p-2 ">
          <h2>Sign Up</h2>
      </div>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        {% include 'Signup/signupLandlord.html' %}
      </div>
    </div>
  </div>
</div>


<!-- Modal SignUp Renter #2-->
<div class="modal fade" id="signupModal2" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="signupModal2" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <div class="p-2">
            <h2>Sign Up</h2>
        </div>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        {% include 'Signup/signupRenter.html' %}
      </div>
    </div>
  </div>
</div>





